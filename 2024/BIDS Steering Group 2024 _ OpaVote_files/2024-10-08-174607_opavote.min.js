// Copyright 2017-2024 Cohere LLC All rights reserved.
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):b(window.jQuery)})(function(b){var g=0;b.ajaxTransport("iframe",function(a){if(a.async){var h=a.initialIframeSrc||"javascript:false;",c,d,e;return{send:function(l,k){c=b('<form style="display:none;"></form>');c.attr("accept-charset",a.formAcceptCharset);e=/\?/.test(a.url)?"&":"?";"DELETE"===a.type?(a.url=a.url+e+"_method=DELETE",a.type="POST"):"PUT"===a.type?(a.url=a.url+e+"_method=PUT",a.type="POST"):"PATCH"===a.type&&(a.url=
a.url+e+"_method=PATCH",a.type="POST");g+=1;d=b('<iframe src="'+h+'" name="iframe-transport-'+g+'"></iframe>').bind("load",function(){var f,e=b.isArray(a.paramName)?a.paramName:[a.paramName];d.unbind("load").bind("load",function(){var a;try{if(a=d.contents(),!a.length||!a[0].firstChild)throw Error();}catch(e){a=void 0}k(200,"success",{iframe:a});b('<iframe src="'+h+'"></iframe>').appendTo(c);window.setTimeout(function(){c.remove()},0)});c.prop("target",d.prop("name")).prop("action",a.url).prop("method",
a.type);a.formData&&b.each(a.formData,function(a,d){b('<input type="hidden"/>').prop("name",d.name).val(d.value).appendTo(c)});a.fileInput&&a.fileInput.length&&"POST"===a.type&&(f=a.fileInput.clone(),a.fileInput.after(function(a){return f[a]}),a.paramName&&a.fileInput.each(function(c){b(this).prop("name",e[c]||a.paramName)}),c.append(a.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),a.fileInput.removeAttr("form"));c.submit();f&&f.length&&a.fileInput.each(function(a,
c){var d=b(f[a]);b(c).prop("name",d.prop("name")).attr("form",d.attr("form"));d.replaceWith(c)})});c.append(d).appendTo(document.body)},abort:function(){d&&d.unbind("load").prop("src",h);c&&c.remove()}}}});b.ajaxSetup({converters:{"iframe text":function(a){return a&&b(a[0].body).text()},"iframe json":function(a){return a&&b.parseJSON(b(a[0].body).text())},"iframe html":function(a){return a&&b(a[0].body).html()},"iframe xml":function(a){return(a=a&&a[0])&&b.isXMLDoc(a)?a:b.parseXML(a.XMLDocument&&
a.XMLDocument.xml||b(a.body).html())},"iframe script":function(a){return a&&b.globalEval(b(a[0].body).text())}}})});
(function(c){"function"===typeof define&&define.amd?define(["jquery","jquery.ui.widget"],c):c(window.jQuery)})(function(c){c.support.fileInput=!(/(Android (1\.[0156]|2\.[01]))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.[05]|3\.0))/.test(window.navigator.userAgent)||c('<input type="file">').prop("disabled"));c.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader);c.support.xhrFormDataFileUpload=!!window.FormData;c.support.blobSlice=
window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);c.widget("blueimp.fileupload",{options:{dropZone:c(document),pasteZone:c(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,
uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(a,b){a=this.messages[a]||a.toString();b&&c.each(b,function(b,e){a=a.replace("{"+b+"}",e)});return a},formData:function(a){return a.serializeArray()},add:function(a,b){if(a.isDefaultPrevented())return!1;(b.autoUpload||!1!==b.autoUpload&&c(this).fileupload("option","autoUpload"))&&b.process().done(function(){b.submit()})},processData:!1,
contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:c.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=this.loaded=0;this.getBitrate=function(a,b,d){var e=a-this.timestamp;if(!this.bitrate||!d||e>d)this.bitrate=1E3/e*(b-this.loaded)*8,this.loaded=b,this.timestamp=a;return this.bitrate}},
_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&c.support.xhrFileUpload||c.support.xhrFormDataFileUpload)},_getFormData:function(a){var b;return"function"===c.type(a.formData)?a.formData(a.form):c.isArray(a.formData)?a.formData:"object"===c.type(a.formData)?(b=[],c.each(a.formData,function(a,e){b.push({name:a,value:e})}),b):[]},_getTotal:function(a){var b=0;c.each(a,function(a,e){b+=e.size||1});return b},_initProgressObject:function(a){var b={loaded:0,total:0,bitrate:0};a._progress?
c.extend(a._progress,b):a._progress=b},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,b){if(a.lengthComputable){var d=Date.now?Date.now():(new Date).getTime(),e;b._time&&b.progressInterval&&d-b._time<b.progressInterval&&a.loaded!==a.total||(b._time=d,e=Math.floor(a.loaded/a.total*(b.chunkSize||b._progress.total))+(b.uploadedBytes||0),this._progress.loaded+=e-b._progress.loaded,
this._progress.bitrate=this._bitrateTimer.getBitrate(d,this._progress.loaded,b.bitrateInterval),b._progress.loaded=b.loaded=e,b._progress.bitrate=b.bitrate=b._bitrateTimer.getBitrate(d,e,b.bitrateInterval),this._trigger("progress",c.Event("progress",{delegatedEvent:a}),b),this._trigger("progressall",c.Event("progressall",{delegatedEvent:a}),this._progress))}},_initProgressListener:function(a){var b=this,d=a.xhr?a.xhr():c.ajaxSettings.xhr();d.upload&&(c(d.upload).bind("progress",function(d){var c=
d.originalEvent;d.lengthComputable=c.lengthComputable;d.loaded=c.loaded;d.total=c.total;b._onProgress(d,a)}),a.xhr=function(){return d})},_isInstanceOf:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var b=this,d,e=a.files[0],f=a.multipart||!c.support.xhrFileUpload,g="array"===c.type(a.paramName)?a.paramName[0]:a.paramName;a.headers=c.extend({},a.headers);a.contentRange&&(a.headers["Content-Range"]=a.contentRange);f&&!a.blob&&this._isInstanceOf("File",
e)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"');f?c.support.xhrFormDataFileUpload&&(a.postMessage?(d=this._getFormData(a),a.blob?d.push({name:g,value:a.blob}):c.each(a.files,function(b,e){d.push({name:"array"===c.type(a.paramName)&&a.paramName[b]||g,value:e})})):(b._isInstanceOf("FormData",a.formData)?d=a.formData:(d=new FormData,c.each(this._getFormData(a),function(a,b){d.append(b.name,b.value)})),a.blob?d.append(g,a.blob,e.name):c.each(a.files,function(e,f){(b._isInstanceOf("File",
f)||b._isInstanceOf("Blob",f))&&d.append("array"===c.type(a.paramName)&&a.paramName[e]||g,f,f.uploadName||f.name)})),a.data=d):(a.contentType=e.type||"application/octet-stream",a.data=a.blob||e);a.blob=null},_initIframeSettings:function(a){var b=c("<a></a>").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);a.redirect&&b&&b!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?
(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var b=c(a.fileInput),d=a.paramName;d?c.isArray(d)||(d=[d]):(d=[],b.each(function(){for(var a=c(this),b=a.prop("name")||"files[]",a=(a.prop("files")||[1]).length;a;)d.push(b),a-=1}),d.length||(d=[b.prop("name")||"files[]"]));return d},_initFormSettings:function(a){a.form&&a.form.length||(a.form=c(a.fileInput.prop("form")),
a.form.length||(a.form=c(this.options.fileInput.prop("form"))));a.paramName=this._getParamName(a);a.url||(a.url=a.form.prop("action")||location.href);a.type=(a.type||"string"===c.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase();"POST"!==a.type&&"PUT"!==a.type&&"PATCH"!==a.type&&(a.type="POST");a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){a=c.extend({},this.options,a);this._initFormSettings(a);this._initDataSettings(a);
return a},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(a,b,d){var e=c.Deferred(),f=e.promise();b=b||this.options.context||f;!0===a?e.resolveWith(b,d):!1===a&&e.rejectWith(b,d);f.abort=e.promise;return this._enhancePromise(f)},_addConvenienceMethods:function(a,b){var d=this,e=function(a){return c.Deferred().resolveWith(d,
a).promise()};b.process=function(a,g){if(a||g)b._processQueue=this._processQueue=(this._processQueue||e([this])).pipe(function(){return b.errorThrown?c.Deferred().rejectWith(d,[b]).promise():e(arguments)}).pipe(a,g);return this._processQueue||e([this])};b.submit=function(){"pending"!==this.state()&&(b.jqXHR=this.jqXHR=!1!==d._trigger("submit",c.Event("submit",{delegatedEvent:a}),this)&&d._onSend(a,this));return this.jqXHR||d._getXHRPromise()};b.abort=function(){if(this.jqXHR)return this.jqXHR.abort();
this.errorThrown="abort";d._trigger("fail",null,this);return d._getXHRPromise(!1)};b.state=function(){if(this.jqXHR)return d._getDeferredState(this.jqXHR);if(this._processQueue)return d._getDeferredState(this._processQueue)};b.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===d._getDeferredState(this._processQueue)};b.progress=function(){return this._progress};b.response=function(){return this._response}},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&
a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(a,b){a.uploadedBytes=a.uploadedBytes||0;var d=this,e=a.files[0],f=e.size,g=a.uploadedBytes,k=a.maxChunkSize||f,h=this._blobSlice,l=c.Deferred(),p=l.promise(),m,n;if(!(this._isXHRUpload(a)&&h&&(g||k<f))||a.data)return!1;if(b)return!0;if(g>=f)return e.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",e.error]);n=function(){var b=c.extend({},a),p=b._progress.loaded;b.blob=h.call(e,g,g+k,e.type);b.chunkSize=
b.blob.size;b.contentRange="bytes "+g+"-"+(g+b.chunkSize-1)+"/"+f;d._initXHRData(b);d._initProgressListener(b);m=(!1!==d._trigger("chunksend",null,b)&&c.ajax(b)||d._getXHRPromise(!1,b.context)).done(function(e,h,k){g=d._getUploadedBytes(k)||g+b.chunkSize;p+b.chunkSize-b._progress.loaded&&d._onProgress(c.Event("progress",{lengthComputable:!0,loaded:g-b.uploadedBytes,total:g-b.uploadedBytes}),b);a.uploadedBytes=b.uploadedBytes=g;b.result=e;b.textStatus=h;b.jqXHR=k;d._trigger("chunkdone",null,b);d._trigger("chunkalways",
null,b);g<f?n():l.resolveWith(b.context,[e,h,k])}).fail(function(a,e,c){b.jqXHR=a;b.textStatus=e;b.errorThrown=c;d._trigger("chunkfail",null,b);d._trigger("chunkalways",null,b);l.rejectWith(b.context,[a,e,c])})};this._enhancePromise(p);p.abort=function(){return m.abort()};n();return p},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(b);this._initProgressObject(b);
b._progress.loaded=b.loaded=b.uploadedBytes||0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(a,b,d,e){var f=e._progress.total,g=e._response;e._progress.loaded<f&&this._onProgress(c.Event("progress",{lengthComputable:!0,loaded:f,total:f}),e);g.result=e.result=a;g.textStatus=e.textStatus=b;g.jqXHR=e.jqXHR=d;this._trigger("done",null,e)},_onFail:function(a,b,d,e){var c=
e._response;e.recalculateProgress&&(this._progress.loaded-=e._progress.loaded,this._progress.total-=e._progress.total);c.jqXHR=e.jqXHR=a;c.textStatus=e.textStatus=b;c.errorThrown=e.errorThrown=d;this._trigger("fail",null,e)},_onAlways:function(a,b,d,c){this._trigger("always",null,c)},_onSend:function(a,b){b.submit||this._addConvenienceMethods(a,b);var d=this,e,f,g,k,h=d._getAJAXSettings(b),l=function(){d._sending+=1;h._bitrateTimer=new d._BitrateTimer;return e=e||((f||!1===d._trigger("send",c.Event("send",
{delegatedEvent:a}),h))&&d._getXHRPromise(!1,h.context,f)||d._chunkedUpload(h)||c.ajax(h)).done(function(a,b,c){d._onDone(a,b,c,h)}).fail(function(a,b,c){d._onFail(a,b,c,h)}).always(function(a,b,c){d._onAlways(a,b,c,h);d._sending-=1;d._active-=1;if(h.limitConcurrentUploads&&h.limitConcurrentUploads>d._sending)for(a=d._slots.shift();a;){if("pending"===d._getDeferredState(a)){a.resolve();break}a=d._slots.shift()}0===d._active&&d._trigger("stop")})};this._beforeSend(a,h);return this.options.sequentialUploads||
this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(1<this.options.limitConcurrentUploads?(g=c.Deferred(),this._slots.push(g),k=g.pipe(l)):k=this._sequence=this._sequence.pipe(l,l),k.abort=function(){f=[void 0,"abort","abort"];return e?e.abort():(g&&g.rejectWith(h.context,f),l())},this._enhancePromise(k)):l()},_onAdd:function(a,b){var d=this,e=!0,f=c.extend({},this.options,b),g=b.files,k=g.length,h=f.limitMultiFileUploads,l=f.limitMultiFileUploadSize,p=f.limitMultiFileUploadSizeOverhead,
m=0,n=this._getParamName(f),q,r,s=0;!l||k&&void 0!==g[0].size||(l=void 0);if((f.singleFileUploads||h||l)&&this._isXHRUpload(f))if(f.singleFileUploads||l||!h)if(!f.singleFileUploads&&l)for(r=[],q=[],f=0;f<k;f+=1){if(m+=g[f].size+p,f+1===k||m+g[f+1].size+p>l||h&&f+1-s>=h)r.push(g.slice(s,f+1)),m=n.slice(s,f+1),m.length||(m=n),q.push(m),s=f+1,m=0}else q=n;else for(r=[],q=[],f=0;f<k;f+=h)r.push(g.slice(f,f+h)),m=n.slice(f,f+h),m.length||(m=n),q.push(m);else r=[g],q=[n];b.originalFiles=g;c.each(r||g,function(f,
g){var h=c.extend({},b);h.files=r?g:[g];h.paramName=q[f];d._initResponseObject(h);d._initProgressObject(h);d._addConvenienceMethods(a,h);return e=d._trigger("add",c.Event("add",{delegatedEvent:a}),h)});return e},_replaceFileInput:function(a){var b=a.clone(!0);c("<form></form>").append(b)[0].reset();a.after(b).detach();c.cleanData(a.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(d,c){return c===a[0]?b[0]:c});a[0]===this.element[0]&&(this.element=b)},_handleFileTreeEntry:function(a,
b){var d=this,e=c.Deferred(),f=function(b){b&&!b.entry&&(b.entry=a);e.resolve([b])},g;b=b||"";a.isFile?a._file?(a._file.relativePath=b,e.resolve(a._file)):a.file(function(a){a.relativePath=b;e.resolve(a)},f):a.isDirectory?(g=a.createReader(),g.readEntries(function(c){d._handleFileTreeEntries(c,b+a.name+"/").done(function(a){e.resolve(a)}).fail(f)},f)):e.resolve([]);return e.promise()},_handleFileTreeEntries:function(a,b){var d=this;return c.when.apply(c,c.map(a,function(a){return d._handleFileTreeEntry(a,
b)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var b=a.items;return b&&b.length&&(b[0].webkitGetAsEntry||b[0].getAsEntry)?this._handleFileTreeEntries(c.map(b,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):c.Deferred().resolve(c.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=c(a);var b=a.prop("webkitEntries")||a.prop("entries");if(b&&b.length)return this._handleFileTreeEntries(b);
b=c.makeArray(a.prop("files"));if(b.length)void 0===b[0].name&&b[0].fileName&&c.each(b,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{a=a.prop("value");if(!a)return c.Deferred().resolve([]).promise();b=[{name:a.replace(/^.*\\/,"")}]}return c.Deferred().resolve(b).promise()},_getFileInputFiles:function(a){return a instanceof c&&1!==a.length?c.when.apply(c,c.map(a,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},
_onChange:function(a){var b=this,d={fileInput:c(a.target),form:c(a.target.form)};this._getFileInputFiles(d.fileInput).always(function(e){d.files=e;b.options.replaceFileInput&&b._replaceFileInput(d.fileInput);!1!==b._trigger("change",c.Event("change",{delegatedEvent:a}),d)&&b._onAdd(a,d)})},_onPaste:function(a){var b=a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items,d={files:[]};b&&b.length&&(c.each(b,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&d.files.push(c)}),
!1!==this._trigger("paste",c.Event("paste",{delegatedEvent:a}),d)&&this._onAdd(a,d))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var b=this,d=a.dataTransfer,e={};d&&d.files&&d.files.length&&(a.preventDefault(),this._getDroppedFiles(d).always(function(d){e.files=d;!1!==b._trigger("drop",c.Event("drop",{delegatedEvent:a}),e)&&b._onAdd(a,e)}))},_onDragOver:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var b=a.dataTransfer;b&&-1!==c.inArray("Files",
b.types)&&!1!==this._trigger("dragover",c.Event("dragover",{delegatedEvent:a}))&&(a.preventDefault(),b.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste}));c.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,
"paste");this._off(this.options.fileInput,"change")},_setOption:function(a,b){var d=-1!==c.inArray(a,this._specialOptions);d&&this._destroyEventHandlers();this._super(a,b);d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof c||(a.fileInput=c(a.fileInput));a.dropZone instanceof c||(a.dropZone=c(a.dropZone));
a.pasteZone instanceof c||(a.pasteZone=c(a.pasteZone))},_getRegExp:function(a){a=a.split("/");var b=a.pop();a.shift();return new RegExp(a.join("/"),b)},_isRegExpOption:function(a,b){return"url"!==a&&"string"===c.type(b)&&/^\/.*\/[igm]{0,3}$/.test(b)},_initDataAttributes:function(){var a=this,b=this.options,d=c(this.element[0].cloneNode(!1));c.each(d.data(),function(c,f){var g="data-"+c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();d.attr(g)&&(a._isRegExpOption(c,f)&&(f=a._getRegExp(f)),b[c]=f)})},
_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var b=this;a&&!this.options.disabled&&(a.fileInput&&!a.files?this._getFileInputFiles(a.fileInput).always(function(c){a.files=c;b._onAdd(null,a)}):(a.files=c.makeArray(a.files),this._onAdd(null,
a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var b=this,d=c.Deferred(),e=d.promise(),f,g;e.abort=function(){g=!0;if(f)return f.abort();d.reject(null,"abort","abort");return e};this._getFileInputFiles(a.fileInput).always(function(c){g||(c.length?(a.files=c,f=b._onSend(null,a).then(function(a,b,c){d.resolve(a,b,c)},function(a,b,c){d.reject(a,b,c)})):d.reject())});return this._enhancePromise(e)}a.files=c.makeArray(a.files);if(a.files.length)return this._onSend(null,
a)}return this._getXHRPromise(!1,a&&a.context)}})});
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);//     (c) 2012 Airbnb, Inc.
//
//     polyglot.js may be freely distributed under the terms of the BSD
//     license. For all licensing information, details, and documention:
//     http://airbnb.github.com/polyglot.js
//
//
// Polyglot.js is an I18n helper library written in JavaScript, made to
// work both in the browser and in Node. It provides a simple solution for
// interpolation and pluralization, based off of Airbnb's
// experience adding I18n functionality to its Backbone.js and Node apps.
//
// Polylglot is agnostic to your translation backend. It doesn't perform any
// translation; it simply gives you a way to manage translated phrases from
// your client- or server-side JavaScript application.
//
(function(e,t){typeof define=="function"&&define.amd?define([],function(){return t(e)}):typeof exports=="object"?module.exports=t(e):e.Polyglot=t(e)})(this,function(e){"use strict";function t(e){e=e||{},this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en",this.allowMissing=!!e.allowMissing,this.warn=e.warn||c}function s(e){var t,n,r,i={};for(t in e)if(e.hasOwnProperty(t)){n=e[t];for(r in n)i[n[r]]=t}return i}function o(e){var t=/^\s+|\s+$/g;return e.replace(t,"")}function u(e,t,r){var i,s,u;return r!=null&&e?(s=e.split(n),u=s[f(t,r)]||s[0],i=o(u)):i=e,i}function a(e){var t=s(i);return t[e]||t.en}function f(e,t){return r[a(e)](t)}function l(e,t){for(var n in t)n!=="_"&&t.hasOwnProperty(n)&&(e=e.replace(new RegExp("%\\{"+n+"\\}","g"),t[n]));return e}function c(t){e.console&&e.console.warn&&e.console.warn("WARNING: "+t)}function h(e){var t={};for(var n in e)t[n]=e[n];return t}t.VERSION="0.4.3",t.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},t.prototype.extend=function(e,t){var n;for(var r in e)e.hasOwnProperty(r)&&(n=e[r],t&&(r=t+"."+r),typeof n=="object"?this.extend(n,r):this.phrases[r]=n)},t.prototype.clear=function(){this.phrases={}},t.prototype.replace=function(e){this.clear(),this.extend(e)},t.prototype.t=function(e,t){var n,r;return t=t==null?{}:t,typeof t=="number"&&(t={smart_count:t}),typeof this.phrases[e]=="string"?n=this.phrases[e]:typeof t._=="string"?n=t._:this.allowMissing?n=e:(this.warn('Missing translation for key: "'+e+'"'),r=e),typeof n=="string"&&(t=h(t),r=u(n,this.currentLocale,t.smart_count),r=l(r,t)),r},t.prototype.has=function(e){return e in this.phrases};var n="||||",r={chinese:function(e){return 0},german:function(e){return e!==1?1:0},french:function(e){return e>1?1:0},russian:function(e){return e%10===1&&e%100!==11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},czech:function(e){return e===1?0:e>=2&&e<=4?1:2},polish:function(e){return e===1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!==1||e%100===11?1:0}},i={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};return t});var election=function(d){function w(){for(var a="",b=0;b<g.contests.length;b++){var c=d("#ballot-"+b);a+="<p><b>"+g.contests[b].title+"</b></p>";var f="choose one"===g.contests[b].ballot_type;c=c.find("ol li");a=f?a+"<ul>":a+"<ol>";for(var e=0;e<c.length;e++)a+="<li>"+d(c[e]).html()+"</li>";0==c.length&&(a+="<li>"+l.t("no_candidate_chosen")+"</li>");a=f?a+"</ul>":a+"</ol>"}return a}function x(){for(var a=!0,b="",c=!0,f=!0,e=0;e<g.contests.length;e++){var h=d("#ballot-"+e),k=g.contests[e].method,n=
g.contests[e].require_full,m=g.contests[e].ballot_type,t=g.contests[e].candidates.length,F=g.contests[e].n_seats;h=h.find("ol li").length;var u=g.contests[e].title;"yes"===n&&(c=!1);0<h&&(f=!1);"Plurality/FPTP/SNTV"===k||"Plurality at Large/Block Voting/MNTV"===k?(k="Plurality/FPTP/SNTV"===k?1:F,"yes"===n&&h!=k&&(b+="<p>",b+=l.t("required_to_select",{smart_count:k,title:u}),b+=".</p>",a=!1),"no"===n&&h>k&&(b+="<p>",b+=l.t("may_select",{smart_count:k,title:u}),b+=".</p>",a=!1)):"ranked enhanced"===
m&&"yes"===n&&h!=t&&(b+="<p>",b+=l.t("must_rank_all",{title:u}),b+=".</p>",a=!1)}e=d("#submit_empty").is(":checked");c&&f&&!e&&(b+="<p>"+l.t("no_candidate_chosen")+".</p>",b+="<p>"+l.t("confirm_empty")+"</p>",a=!1);return{valid:a,msg:b}}function G(a){var b=x();var c=b.msg;b.valid?(b=l.t("please_confirm"),opavote_dlg.confirm_vote(a,w(),b,l.t("confirm"),l.t("go_back")),a=void 0):(opavote_dlg.msg_md(c,l.t("ballot_error")),a=!1);return a}function y(a){var b=d(a.delegateTarget);a=d(a.target);var c=a.data("token");
if(a.hasClass("checked"))b.find("ol #"+c).remove();else{var f=parseInt(b.attr("id").replace(/[^0-9]/g,""),10),e=g.contests[f].method;if("Plurality/FPTP/SNTV"===e||"Plurality at Large/Block Voting/MNTV"===e)f=g.contests[f].n_seats,e="Plurality/FPTP/SNTV"===e?1:f,b.find("ol li").length==e&&(remove_id=b.find("ol li").first().attr("id"),b.find("ol li").first().remove(),$remove_cand=b.find('ul li[data-token="'+remove_id+'"]'),$remove_cand.toggleClass("empty checked"));e=d("<li>"+a.html()+"</li>");e.attr("id",
c);b.find("ol").append(e)}a.toggleClass("empty checked");z()}function A(a){var b=d(a.target);a=d(a.delegateTarget);var c=b.next().html(),f=b.parent().attr("class");"add"===(b.hasClass("add")?"add":"remove")?(c=d("<li>"+c+"</li>"),c.attr("id",f),a.find("ol").append(c),b.html(l.t("remove"))):(a.find("#"+f).remove(),b.html(l.t("add")));b.toggleClass("add remove");z()}function H(a,b){b=g.contests[b].ballot_type;if("choose one"!==b){"ranked enhanced"===b&&a.find("ul li button").each(function(){this.click()});
var c=a.find(".ballot-box"),f=Math.max(150,parseFloat(c.css("width")));c.css("width",f+"px");f=c.css("height");c.css("height",f);f=a.find("ol li").length;for(var e=0;e<f;e++){var h=d("<p>"+(e+1)+".</p>").css("position","absolute"),k=c.find("ol li")[e];k=parseInt(d(k).position().top,10)+7;h.css("top",k+"px");h.css("left",6);c.append(h)}"ranked enhanced"===b&&(a=a.find(".candidate-list"),b=parseFloat(a.css("width")),a.find("li button").each(function(){this.click()}),c=parseFloat(a.css("width")),f=Math.max(b,
c),a.css("width",f+"px"))}}function B(){for(var a=0;a<g.contests.length;a++){var b=d("#ballot-"+a).find("ol");d("#order-"+a).val(b.sortable("serialize"))}}function r(a,b){var c,f=[];for(c=0;c<a;c++)f.push(c);if("no"==b)return f;if(a)for(;--a;)c=Math.floor(Math.random()*(a+1)),b=f[c],f[c]=f[a],f[a]=b;return f}function C(){for(var a=0;a<g.contests.length;a++){var b=d("#ballot-"+a);b.addClass("ballot-wrapper");var c=g.contests[a].ballot_type;if("choose one"===c){c=b;var f=c.html,e=a,h=g.contests[e];
var k='<div class="notranslate ballot-box choose-one">\n<p>'+l.t("your_ballot")+":</p>\n<ul>\n";for(var n=r(h.candidates.length,h.shuffle_cand),m=0;m<h.candidates.length;m++)k+='<li class="empty" data-token="r'+(e+"_"+n[m])+'">'+h.candidates[n[m]]+"</li>\n";f.call(c,k+"</ul>\n<ol></ol>\n</div>\n");b.on("click","ul li",y)}else if("ranked simple"===c){c=b;f=c.html;e=a;h=g.contests[e];k='<div class="notranslate ballot-box">\n<p>'+l.t("your_ballot")+":</p>\n<ol>\n";n=r(h.candidates.length,h.shuffle_cand);
for(m=0;m<h.candidates.length;m++)k+='<li id="r'+(e+"_"+n[m])+'">'+h.candidates[n[m]]+"</li>\n";f.call(c,k+"</ol>\n</div>\n")}else if("ranked enhanced"===c){c=b;f=c.html;e=a;h=g.contests[e];k='<div class="notranslate candidate-list">\n<p>'+l.t("choice_list")+":</p>\n<ul>\n";n=r(h.candidates.length,h.shuffle_cand);for(m=0;m<h.candidates.length;m++){var t=h.candidates[n[m]];k+='<li class="r'+(e+"_"+n[m])+'">';k+='<button type="button" class="btn btn-default btn-sm add">'+l.t("add")+"</button><span>"+
t+"</span>";k+="</li>\n"}k+='</ul>\n</div>\n<div class="notranslate ballot-box">\n<p>'+l.t("your_ballot")+":</p>\n<ol></ol>\n</div>\n";f.call(c,k);b.on("click","ul li button",A)}c=b.find(".ballot-box");b.find("ol").sortable({axis:"y",containment:c,scroll:!1});b.find("ol").disableSelection();H(b,a)}}function D(a){d("#opavote-voting").show();if(a.error)d("#opavote-voting").html("<p><b>"+a.msg+"</b></p>");else{var b=0<=document.cookie.indexOf(g.eid+"=true")?l.t("already_voted")+".":l.t("vote_entered")+
".";d("#opavote-voting").html("<p><b>"+b+"</b></p>");d("#opavote-voted").show();d("#opavote-results").html(a.html);"cookie"==g.poll_registration&&(a=new Date,a.setDate(a.getDate()+30),document.cookie=g.eid+"=true; expires="+a.toUTCString())}}function I(){if(0!=d("#ballot-0 ol li").length){d("#vote-button").html(l.t("sending_vote"));for(var a=q+"/api/v1/widget-vote/"+g.eid+"?callback=?",b={},c=0;c<g.contests.length;c++){var f=d("#ballot-"+c).find("ol");b["order-"+c]=f.sortable("serialize")}d.getJSON(a,
b,D).fail(v)}}function J(a){g=a;var b;if(d("#opavote-widget").length){a=!1;var c=d("#opavote-logo a").attr("href"),f=d("#opavote-logo a").text();d("#opavote-widget #opavote-voting").length&&d("#opavote-voting #ballot-0").length&&d("#opavote-voting #vote-button").length&&d("#opavote-widget #opavote-voted").length&&d("#opavote-voted #opavote-results").length&&d("#opavote-widget #opavote-logo").length?"https://opavote.com"!=c||"OpaVote"!=f?b="To use the OpaVote poll widget, you must keep the OpaVote attribution!":
a=!0:b="You have copied the OpaVote widget code incorrectly. Please check our documentation.";a||d("#opavote-widget").html("<p><b>"+b+"</b></p>");b=a}else b=!1;if(b){b=!1;var e;g.error?e=g.msg:"poll"!=g.mode?e="OpaVote widget only works for polls!":1<g.contests.length?e="OpaVote poll widget only works with one contest.":"yes"==g.contests[0].require_full?e='OpaVote widget only works with "require full vote" set to no.':"EDITING"==g.status?e="Voting has not opened yet.":b=!0;b||d("#opavote-widget").html("<p><b>"+
e+"</b></p>");b&&("VOTING"!=g.status||0<=document.cookie.indexOf(g.eid+"=true")?d.getJSON(q+"/api/v1/widget-results/"+g.eid+"?callback=?",D).fail(v):(d("#opavote-voting").show(),C(),d("#vote-button").html('<button type="button" class="btn btn-lg btn-success">'+l.t("vote")+"</button>"),d("#vote-button button").click(I)))}}function v(){alert("Error retrieving poll data.")}function z(){const a=d("#submit_empty_ballot_holder");0<d(".ballot-wrapper li.checked,.ballot-wrapper button.remove").length?a.hide():
a.show()}var p={},g,q,l,E={en:{add:"Add",already_voted:"You have already voted in this poll",ballot_error:"Ballot Error",choice_list:"Choice list",confirm:"Confirm",confirm_empty:"Check the 'I want to submit an empty ballot' box to confirm your ballot is intentionally empty.",go_back:"Go Back",may_select:"You may select up to %{smart_count} choice for %{title}||||You may select up to %{smart_count} choices for %{title}",must_rank_all:"You must rank all choices for %{title}",no_candidate_chosen:"No choices made",
please_confirm:"Please confirm your ballot",remove:"Remove",required_to_select:"You are required to select exactly %{smart_count} choice for %{title}||||You are required to select exactly %{smart_count} choices for %{title}",sending_vote:"Sending vote...",vote:"Vote!",vote_entered:"Your vote has been entered",your_ballot:"Your ballot"},es:{add:"A\u00f1adir",already_voted:"Ya vot\u00f3 en esta encuesta",ballot_error:"Error de boleta electoral",choice_list:"Lista de opciones",confirm:"Confirmar",confirm_empty:"Marque la casilla 'Deseo enviar una boleta vac\u00eda' para confirmar que su boleta est\u00e1 intencionalmente vac\u00eda.",
go_back:"Regresar",may_select:"Puede elegir hasta %{smart_count} opci\u00f3n para %{title}||||Puede elegir hasta %{smart_count} opciones para %{title}",must_rank_all:"Debe clasificar todas las opciones para %{title}",no_candidate_chosen:"No hay opciones seleccionadas",please_confirm:"Por favor confirme su voto",remove:"Eliminar",required_to_select:"Se le solicita que seleccione solo %{smart_count} opci\u00f3n para %{title}||||Se le solicita que seleccione solo %{smart_count} opciones para %{title}",
sending_vote:"Enviando voto...",vote:"\u00a1Votar!",vote_entered:"Su voto ha sido introducido",your_ballot:"Su voto"},fr:{add:"Ajouter",already_voted:"Vous avez d\u00e9j\u00e0 particip\u00e9 \u00e0 ce vote",ballot_error:"Erreur de vote",choice_list:"Liste de choix",confirm:"Confirmer",confirm_empty:"Cochez la case 'Je veux soumettre un bulletin de vote vide' pour confirmer que votre bulletin de vote est intentionnellement vide.",go_back:"Retour",may_select:"Vous pouvez s\u00e9lectionner jusqu'\u00e0 %{smart_count} choix pour %{title}||||Vous pouvez s\u00e9lectionner jusqu'\u00e0 %{smart_count} choix pour %{title}",
must_rank_all:"Vous devez classer tous les choix pour %{title}",no_candidate_chosen:"Aucun choix s\u00e9lectionn\u00e9",please_confirm:"Veuillez confirmer votre bulletin de vote",remove:"Retirer",required_to_select:"Vous devez choisir exactement %{smart_count} choix pour %{title}||||Vous devez choisir exactement %{smart_count} choix pour %{title}",sending_vote:"Envoi du bulletin de vote...",vote:"Vote!",vote_entered:"Votre vote a bien \u00e9t\u00e9 enregistr\u00e9",your_ballot:"Votre bulletin"},pt:{add:"Adicionar",
already_voted:"Voc\u00ea j\u00e1 votou nesta enquete",ballot_error:"Erro na vota\u00e7\u00e3o",choice_list:"Lista de escolhas",confirm:"Confirmar",confirm_empty:"Marque a caixa 'Desejo enviar um boletim de voto em branco' para confirmar que seu boletim de voto est\u00e1 intencionalmente em branco.",go_back:"Voltar",may_select:"Voc\u00ea pode selecionar at\u00e9 %{smart_count} escolha para %{title}||||Voc\u00ea pode selecionar at\u00e9 %{smart_count} escolhas para o %{title}",must_rank_all:"Voc\u00ea deve classificar todas as escolhas para %{title}",
no_candidate_chosen:"Nenhuma escolha feita",please_confirm:"Por favor, confirme sua vota\u00e7\u00e3o",remove:"Remover",required_to_select:"Voc\u00ea precisa selecionar exatamente %{smart_count} escolha para %{title}||||Voc\u00ea precisa selecionar exatamente %{smart_count} op\u00e7\u00f5es para %{title}",sending_vote:"Enviando voto...",vote:"Votar!",vote_entered:"Seu voto foi registrado",your_ballot:"Sua vota\u00e7\u00e3o"},sk:{add:"Prida\u0165",already_voted:"U\u017e ste hlasovali",ballot_error:"Chyba hlasovacieho l\u00edstka",
choice_list:"Zoznam mo\u017enost\u00ed",confirm:"Potvrdi\u0165",confirm_empty:"Za\u0161krtnite pol\u00ed\u010dko 'Chcem odosla\u0165 pr\u00e1zdny hlasovac\u00ed l\u00edstok' pre potvrdenie, \u017ee chcete odosla\u0165 pr\u00e1zdny hlasovac\u00ed l\u00edstok.",go_back:"Sp\u00e4\u0165",may_select:"M\u00f4\u017eete vybra\u0165 najviac %{smart_count} mo\u017enos\u0165 pre %{title}||||M\u00f4\u017eete vybra\u0165 najviac %{smart_count} mo\u017enosti pre %{title}||||M\u00f4\u017eete vybra\u0165 najviac %{smart_count} mo\u017enost\u00ed pre %{title}",
must_rank_all:"Mus\u00edte zoradi\u0165 v\u0161etky mo\u017enosti pre %{title}",no_candidate_chosen:"Neboli vybran\u00e9 \u017eiadne mo\u017enosti",please_confirm:"Pros\u00edm, potvr\u010fte V\u00e1\u0161 hlasovac\u00ed l\u00edstok",remove:"Odstr\u00e1ni\u0165",required_to_select:"Mus\u00edte vybra\u0165 pr\u00e1ve %{smart_count} mo\u017enos\u0165 pre %{title}||||Mus\u00edte vybra\u0165 pr\u00e1ve %{smart_count} mo\u017enosti pre %{title}||||Mus\u00edte vybra\u0165 pr\u00e1ve %{smart_count} mo\u017enost\u00ed pre %{title}",
sending_vote:"Posielam hlasovanie...",vote:"Hlasova\u0165!",vote_entered:"Va\u0161e hlasovanie bolo zaznamenan\u00e9",your_ballot:"V\u00e1\u0161 hlasovac\u00ed l\u00edstok"},it:{add:"Inserisci",already_voted:"Hai gi\u00e0 votato in questa elezione",ballot_error:"Errore di voto",choice_list:"Lista di scelte",confirm:"Conferma",confirm_empty:"Seleziona la casella 'Voglio inviare una scheda vuota' per confermare che la tua scheda \u00e8 intenzionalmente vuota.",go_back:"Torna indietro",may_select:"Puoi selezionare fino a %{smart_count} scelta per %{title}||||Puoi selezionare fino a %{smart_count} scelta per %{title}",
must_rank_all:"Devi ordinare tutte le scelte per %{title}",no_candidate_chosen:"Nessuna scelta effettuata",please_confirm:"Per favore conferma il tuo voto",remove:"Rimuovi",required_to_select:"\u00c8 necessario selezionare %{smart_count} scelta per %{title}||||\u00c8 necessario selezionare %{smart_count} scelte per %{title}",sending_vote:"Invio del voto ...",vote:"Vota!",vote_entered:"Il tuo voto \u00e8 stato registrato",your_ballot:"Il tuo voto"},fi:{add:"Lis\u00e4\u00e4",already_voted:"Olet jo \u00e4\u00e4nest\u00e4nyt t\u00e4ss\u00e4 kyselyss\u00e4",
ballot_error:"\u00c4\u00e4nestysvirhe",choice_list:"Valintaluettelo",confirm:"Vahvista",confirm_empty:"Valitse 'Haluan l\u00e4hett\u00e4\u00e4 tyhj\u00e4n \u00e4\u00e4nestyslipun' -ruutu vahvistaaksesi, ett\u00e4 \u00e4\u00e4nestyslippusi on tarkoituksella tyhj\u00e4.",go_back:"Palaa",may_select:"Voit valita enint\u00e4\u00e4n %{smart_count} vaihtoehdon \u00e4\u00e4nestyksess\u00e4 %{title}||||Voit valita enint\u00e4\u00e4n %{smart_count} vaihtoehtoa \u00e4\u00e4nestyksess\u00e4 %{title}",must_rank_all:"Sinun on arvotettava kaikki vaihtoehdot \u00e4\u00e4nestyksess\u00e4 %{title}",
no_candidate_chosen:"Ei valintoja",please_confirm:"Vahvista valintasi",remove:"Poista",required_to_select:"Sinun on valittava tarkalleen %{smart_count} vaihtoehto \u00e4\u00e4nestyksess\u00e4 %{title}||||Sinun on valittava tarkalleen %{smart_count} vaihtoehtoa \u00e4\u00e4nestyksess\u00e4 %{title}",sending_vote:"L\u00e4hetet\u00e4\u00e4n \u00e4\u00e4nt\u00e4...",vote:"\u00c4\u00e4nest\u00e4!",vote_entered:"\u00c4\u00e4nesi on annettu",your_ballot:"Sinun valintasi"}};p.init=function(a){if(null!==a){var b=
d("#data-locale").data("locale");l=new Polyglot({phrases:E[b]});g=a;C();d("#enter-vote-btn").prop("disabled",!1);d("#enter-vote-btn").click(G);d("#ballot-form").submit(B)}};p.widget=function(a,b){var c=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage;c=c.split("-",1)[0];c=-1==["en","fr"].indexOf(c)?"en":c;l=new Polyglot({phrases:E[c]});q=b;"undefined"===typeof q&&(q="https://opavote.com");d.getJSON(q+"/api/v1/items/"+a+"?callback=?",J).fail(v)};p._get_order=
r;p._toggle_candidate=A;p._check_candidate=y;p._validate_vote=x;p._get_vote_preview=w;p._vote_submission=B;return p}(jQuery);
$(document).ready(function(){$("form").submit(function(){if(this.beenSubmitted)return!1;this.beenSubmitted=!0})});(function(d,a,c,l,h,k,f){d.GoogleAnalyticsObject=h;d[h]=d[h]||function(){(d[h].q=d[h].q||[]).push(arguments)};d[h].l=1*new Date;k=a.createElement(c);f=a.getElementsByTagName(c)[0];k.async=1;k.src=l;f.parentNode.insertBefore(k,f)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");var path=window.location.pathname;path=path.replace(/[0-9]+.*/,"");
var status=$("#data").data("status"),payments=$("#data").data("payments");"/payments"==path&&0<Number(payments)&&(path="/payments/customer");"/manage/"==path&&(path+=status.toLowerCase());ga("create","UA-9453549-3","auto");ga("set","page",path);ga("send","pageview");
function newsletter(){$(".close").click(function(){$("#subscribe-form").alert("close")});$("#subscribe-form").on("closed.bs.alert",function(){var d=new Date;d.setDate(d.getDate()+7);document.cookie="newsletter=true; expires="+d.toUTCString()})}
var opavote_dlg=function(){var d={dlg:function(a,c,l,h,k,f){"undefined"===typeof l&&(l="OpaVote Message");"undefined"===typeof k&&(more_options={show:!0});"undefined"===typeof f&&(f=".btn-default");a='<div id="dynamic-modal" class="modal fade"><div class="modal-dialog '+a+'"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span></button><h4 class="modal-title">'+(l+'</h4></div><div class="modal-body">'+
c+"</div>");if("undefined"!=typeof h){a+='<div class="modal-footer">';for(var e in h){a+='<button type="button" '+h[e]+">";if("Cancel"==e||"Go Back"==e)a+='<span class="glyphicon glyphicon-remove"></span> ';if("Confirm"==e||"OK"==e)a+='<span class="glyphicon glyphicon-ok"></span> ';a+=e+"</button>"}a+="</div>"}a+="</div></div></div>";var g=$(a).modal(k);g.on("shown.bs.modal",function(){g.find(f).focus()});g.on("hidden.bs.modal",function(){g.remove()});return g},msg_sm:function(a,c){return d.dlg("modal-sm",
a,c)},msg_md:function(a,c){return d.dlg("",a,c)},msg_lg:function(a,c){return d.dlg("modal-lg",a,c)},confirm_vote:function(a,c,l,h,k){if(a.originalEvent){var f=$(a.target);a.preventDefault();a={};a[k]='class="btn btn-default" data-dismiss="modal"';a[h]='class="btn btn-primary" id="confirm-btn"';var e=d.dlg("",c,l,a);e.on("click","#confirm-btn",function(){e.modal("hide");f.click()});return!1}}};return d}(),account=function(){return{init:function(){$("#key-link").hide();var d=$("#key-button");d.click(function(){$("#key-link").toggle();
d.text("Show"===d.text()?"Hide":"Show")})}}}(),set_locale=function(){return{init:function(){var d=$("#data-locale").data("locale");$('#locale select option[value="'+d+'"]').prop("selected",!0);$("#locale select").change(function(){var a=new Date;a.setDate(a.getDate()+30);d=$("#locale option:selected").val();document.cookie="locale="+d+"; expires="+a.toUTCString()+"; path=/;";location.reload(!0)})}}}(),compute_price=function(){function d(){var c=$("#item-btns .btn-success").attr("id"),l=$("#voters").val();
c="poll-btn"===c||25>=l?0:l/12.5;l=$("#candidates").val();c=Math.max(c,10>=l?0:l/2);q=Math.floor(c/10);r=c%10;c=10*q+(r?10:0);c=Math.round(c);$("#price").text(c)}function a(c){$("#item-btns button").removeClass("btn-success");$("#item-btns button").addClass("btn-default");c=$(c.target);c.addClass("btn-success");c.removeClass("btn-default");"poll-btn"===c.attr("id")?($("#unlimited").show(),$("#voters").hide()):($("#unlimited").hide(),$("#voters").show());d()}return{init:function(){$("#unlimited").hide();
$("#item-btns button").on("click",a);$("#weeks").on("input",d);$("#voters").on("input",d);$("#candidates").on("input",d);var c=$("#voters").parent();c.height(c.height());d()}}}(),manage_editing=function(){function d(e,g,m){"Approval Voting"===g?(e.find('[id$="-ballot_type"]').parent().parent().slideUp(),e.find('[id$="-require_full"]').parent().parent().slideUp()):"Plurality/FPTP/SNTV"===g||"Plurality at Large/Block Voting/MNTV"===g?(e.find('[id$="-ballot_type"]').parent().parent().slideUp(),e.find('[id$="-require_full"]').parent().parent().slideDown()):
(e.find('[id$="-ballot_type"]').parent().parent().slideDown(),"ranked enhanced"===m?e.find('[id$="-require_full"]').parent().parent().slideDown():e.find('[id$="-require_full"]').parent().parent().slideUp())}function a(e){var g=$(e.delegateTarget);e=$(e.target).val();var m=g.find('[id$="-ballot_type"]').val();d(g,e,m)}function c(e){var g=$(e.delegateTarget);e=$(e.target).val();var m=g.find('[id$="-method"]').val();d(g,m,e)}function l(e){var g=$("#tab").val();e=$(e.delegateTarget).children().first().attr("href").substr(1);
$("#tab").val(e);"info"===g&&$("#manage").data("changed")&&$('button[value="save"]:first').click()}var h={},k,f;h.init=function(){k=$("#data-eid").data("eid");$('[value^="\u2550"]').attr("disabled",!0);$(".edit-contest").each(function(){var g=$(this),m=g.find('[id$="-method"]').val(),A=g.find('[id$="-ballot_type"]').val();d(g,m,A);g.on("change",'[id$="-method"]',a);g.on("change",'[id$="-ballot_type"]',c)});$("#manage_start_date").datepicker({minDate:0,maxDate:7});$("#manage_stop_date").datepicker({minDate:0});
$("#email-upload").fileupload({url:"/ajax/"+k+"/set-emails",dataType:"json",maxNumberOfFiles:1,maxFileSize:1E7,formAcceptCharset:"utf-8",start:function(g){f=opavote_dlg.msg_sm("Processing voter list. Please wait for confirmation.")},done:function(g,m){m.result.error?(f.modal("hide"),$("#progress .progress-bar").css("width","0%"),opavote_dlg.msg_sm(m.result.msg)):$('button[value="save"]:first').click()},progressall:function(g,m){g=parseInt(m.loaded/m.total*100,10);$("#progress .progress-bar").css("width",
g+"%")}});$("#weight-upload").fileupload({url:"/ajax/"+k+"/set-weights",dataType:"json",maxNumberOfFiles:1,maxFileSize:1E7,formAcceptCharset:"utf-8",start:function(g){f=opavote_dlg.msg_sm("Processing weights. Please wait for confirmation.")},done:function(g,m){m.result.error?(f.modal("hide"),$("#progress .progress-bar").css("width","0%"),opavote_dlg.msg_sm(m.result.msg)):$('button[value="save"]:first').click()},progressall:function(g,m){g=parseInt(m.loaded/m.total*100,10);$("#progress .progress-bar").css("width",
g+"%")}});$("#manage :input").change(function(){$("#manage").data("changed",!0)});var e=$("#tab").val();$('a[href="#'+e+'"]').tab("show");$("ul.nav-tabs li").click(l)};return h}(),manage_voting=function(){function d(){$("#edit-preview-btns").slideUp();$("#email-txt-editor").slideDown()}function a(){$("#edit-preview-btns").slideDown();$("#email-txt-editor").slideUp()}function c(f){$("#n_pending").text(f.n_pending);$("#n_in_transit").text(f.n_in_transit);$("#n_rejected").text(f.n_rejected);$("#n_bounces").text(f.n_bounces);
$("#n_complaints").text(f.n_complaints);$("#n_opt_out_both").text(f.n_opt_out_both);$("#n_delivered").text(f.n_delivered);$("#n_opens").text(f.n_opens);$("#n_unique_opens").text(f.n_unique_opens);$("#n_visits").text(f.n_visits);$("#n_unique_visits").text(f.n_unique_visits);$(".n_votes").text(f.n_votes);$("#n_not_voted").text(f.n_not_voted);$("#n_disabled").text(f.n_disabled)}function l(){$.get("/ajax/"+k+"/voter-stats").done(c);$("#refresh-stats-btn").prop("disabled",!0);setTimeout(function(){$("#refresh-stats-btn").prop("disabled",
!1)},5E3)}var h={},k;h.init=function(){k=$("#data-eid").data("eid");$("#refresh-stats-btn").click(l);$("#email-txt-editor").hide();$("#edit-email-txt-btn").click(d);$("#cancel-email-txt-btn").click(a)};return h}(),manage_end=function(){return{init:function(){}}}(),manage_count=function(){function d(h){var k=h.candidates;h=h.withdrawn;if(k.length){for(var f="<p>Check candidates to withdraw them:</p>",e=0;e<k.length;e++)f+='<div class="checkbox"><label>',f=-1!=h.indexOf(e)?f+'<input type="checkbox" checked>':
f+'<input type="checkbox">',f+=k[e],f+="</label></div>";var g=opavote_dlg.dlg("modal-sm",f,"Withdraw candidates",{Cancel:'class="btn btn-default" data-dismiss="modal"',OK:'class="btn btn-primary" id="ok-dlg-btn"'});g.on("click","#ok-dlg-btn",function(){for(var m=g.find("input:checkbox"),A=[],B=0;B<m.length;B++)$(m[B]).is(":checked")&&A.push(B);g.modal("hide");$.ajax({type:"POST",url:"/ajax/"+c+"/set-withdrawn-json",data:JSON.stringify(A),contentType:"application/json; charset=utf-8",dataType:"json"})})}else opavote_dlg.msg_sm("You need to provide ballots before withdrawing candidates.")}
var a={},c,l;a.init=function(){c=$("#data-eid").data("eid");$("#blt-fileupload").fileupload({url:"/ajax/"+c+"/set-ballots",dataType:"json",maxNumberOfFiles:1,maxFileSize:1E7,formAcceptCharset:"utf-8",start:function(h){l=opavote_dlg.msg_sm("Processing ballots. Please wait for confirmation.")},done:function(h,k){k.result.error?(l.modal("hide"),$("#progress .progress-bar").css("width","0%"),opavote_dlg.msg_sm(k.result.msg)):window.location.href=window.location.href},progressall:function(h,k){h=parseInt(k.loaded/
k.total*100,10);$("#progress .progress-bar").css("width",h+"%")}});$("#blt-fileappend").fileupload({url:"/ajax/"+c+"/append-ballots",dataType:"json",maxNumberOfFiles:1,maxFileSize:1E7,formAcceptCharset:"utf-8",start:function(h){l=opavote_dlg.msg_sm("Processing ballots. Please wait for confirmation.")},done:function(h,k){k.result.error?(l.modal("hide"),$("#progress .progress-bar").css("width","0%"),opavote_dlg.msg_sm(k.result.msg)):$('button[value="save"]').click()},progressall:function(h,k){h=parseInt(k.loaded/
k.total*100,10);$("#progress .progress-bar").css("width",h+"%")}});$("#withdraw-cand-btn").click(function(){$.get("/ajax/"+c+"/get-withdrawn-json",d,"json")})};return a}(),ballot_editor=function(){function d(b){n=b;t=n.ballots.length;0==t&&(n.ballots.push({weight:1,vote:[]}),t+=1);p=0;n.candidates.length?F():a()}function a(){var b=opavote_dlg.dlg("",'<p>Enter candidate names, one per line. You cannot change these later so double check before proceeding. Candidate names longer than 20 characters will be truncated.</p><textarea style="width:100%;" rows=10></textarea>',
"Enter ballot file",{Cancel:'class="btn btn-default" data-dismiss="modal"',OK:'class="btn btn-primary" id="ok-dlg-btn"'},void 0,"textarea"),y=b.find("textarea");b.on("click","#ok-dlg-btn",function(){var u=y.val().split("\n");b.modal("hide");for(var v=[],z=0;z<u.length;z++)u[z].length&&v.push(u[z].substr(0,20));u=[];z={};for(var C=0;C<v.length;C++)z[v[C]]=1;for(C in z)u.push(C);u.length!=v.length?opavote_dlg.msg_sm("Error: Two candidates have the same name."):v.length&&(n.candidates=v,F())})}function c(){for(var b=
0;b<x.length;b++)x.eq(b).val("");for(b=0;b<n.ballots[p].vote.length;b++)x.eq(n.ballots[p].vote[b]).val(b+1);$("#current-blt").text(p+1);D.val(n.ballots[p].weight)}function l(){p=0;c()}function h(){p<t-1&&(p+=1,c())}function k(){0<p&&(--p,c())}function f(){p=t-1;c()}function e(){for(var b=0;b<x.length;b++)x.eq(b).val("");n.ballots[p].weight=1;n.ballots[p].vote=[]}function g(){1<t&&(n.ballots.splice(p,1),--t,$("#blt-n-ballots").text(t),p===t&&--p,c())}function m(){n.ballots.splice(p,0,{weight:1,vote:[]});
t+=1;$("#blt-n-ballots").text(t);c()}function A(){n.ballots.push({weight:1,vote:[]});t+=1;$("#blt-n-ballots").text(t);p=t-1;c()}function B(b){b=$(b.currentTarget).index()-1;if(x.eq(b).val())b=$.inArray(b,n.ballots[p].vote),n.ballots[p].vote.splice(b,1),c();else{var y=x.filter(function(){return 0!==this.value.length}).length;x.eq(b).val(y+1);n.ballots[p].vote.push(b)}}function H(b){w=parseInt(D.val(),10);if(isNaN(w)||1>w)w=1;n.ballots[p].weight=w}function I(b){opavote_dlg.msg_sm(b.msg);$("#n-total-ballots").text(b.n_total_ballots);
$("#n-votes").text(b.n_votes);$("#n-cand").text(b.n_cand);$("#price").text(b.price);b.can_edit?$("#blt-edit-btn").prop("disabled",!1):$("#blt-edit-btn").prop("disabled",!0)}function F(){var b=opavote_dlg.dlg("modal-lg",G.html(),"Ballot Editor",{"Save and Exit":'class="btn btn-primary" id="save-dlg-btn"'},{backdrop:"static",keyboard:!1},!1);b.find("#blt-n-ballots").text(t);b.find("#blt-title").val(n.title);b.find("#blt-n-winners").val(n.n_seats);for(var y=b.find("table#blt-candidates"),u="<tr><th>Rank</th><th>Candidate</th></tr>",
v=0;v<n.candidates.length;v++)u+="<tr>",u+='<td><input type="text" size="3" readonly></td>',u+="<td>"+n.candidates[v]+"</td>",u+="</tr>";y.html(u);x=y.find("input");D=b.find("#blt-weight");c();b.modal("show");b.on("change","#blt-title",function(){n.title=$("#blt-title").val()});b.on("change","#blt-n-winners",function(){n.n_seats=$("#blt-n-winners").val()});y.on("click","tr",B);D.change(H);b.on("click","#blt-delete",g);b.on("click","#blt-insert",m);b.on("click","#blt-append",A);b.on("click","#blt-first",
l);b.on("click","#blt-next",h);b.on("click","#blt-prev",k);b.on("click","#blt-last",f);b.on("click","#blt-clear",e);b.on("click","#save-dlg-btn",function(){b.modal("hide");$.ajax({type:"POST",url:"/ajax/"+E+"/set-ballots-json",data:JSON.stringify({blt:n}),contentType:"application/json; charset=utf-8",dataType:"json",success:I})})}var E,G,n,t,x,D,p;return{init:function(){E=$("#data-eid").data("eid");G=$("#ballot-editor-template").detach();$("#blt-edit-btn").click(function(){$.get("/ajax/"+E+"/get-ballots-json",
d,"json")})}}}(),method_options=function(){function d(){var a=$("#method").val();$("#method-options").children().hide();"Borda Count"==a?$("#ballotCompletion").parent().slideDown():"Instant Runoff Voting"==a?($("#batchElimination").parent().slideDown(),$("#weakTieBreakMethod").parent().slideDown()):"Random Transfer STV"==a?($("#dynamicThreshold").parent().slideDown(),$("#delayedTransfer").parent().slideDown(),$("#batchElimination").parent().slideDown(),$("#weakTieBreakMethod").parent().slideDown()):
"Fractional Transfer STV"==a?($("#prec").parent().slideDown(),$("#dynamicThreshold").parent().slideDown(),$("#fractionalThreshold").parent().slideDown(),$("#delayedTransfer").parent().slideDown(),$("#batchElimination").parent().slideDown(),$("#weakTieBreakMethod").parent().slideDown()):/^Meek STV|Warren STV$/.test(a)&&($("#prec").parent().slideDown(),$("#dynamicThreshold").parent().slideDown(),$("#fractionalThreshold").parent().slideDown(),$("#weakTieBreakMethod").parent().slideDown())}return{init:function(){$('[value^="\u2550"]').attr("disabled",
!0);$("#method-options").children().hide();$("#method-options").show();d();$("#method").change(d)}}}();function configure_trix_editor(){document.addEventListener("trix-before-initialize",function(d){Trix.config.toolbar.getDefaultHTML=function(){const a=Trix.config.lang;return`<div class="custom-trix-button-row">
      <span class="trix-button-group trix-button-group--text-tools" data-trix-button-group="text-tools">
        <button type="button" class="trix-button trix-button--icon trix-button--icon-bold" data-trix-attribute="bold" data-trix-key="b" title="${a.bold}" tabindex="-1">${a.bold}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-italic" data-trix-attribute="italic" data-trix-key="i" title="${a.italic}" tabindex="-1">${a.italic}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-strike" data-trix-attribute="strike" title="${a.strike}" tabindex="-1">${a.strike}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-link" data-trix-attribute="href" data-trix-action="link" data-trix-key="k" title="${a.link}" tabindex="-1">${a.link}</button>
      </span>

      <span class="trix-button-group trix-button-group--block-tools" data-trix-button-group="block-tools">
        <button type="button" class="trix-button trix-button--icon trix-button--icon-quote" data-trix-attribute="quote" title="${a.quote}" tabindex="-1">${a.quote}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-code" data-trix-attribute="code" title="${a.code}" tabindex="-1">${a.code}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-bullet-list" data-trix-attribute="bullet" title="${a.bullets}" tabindex="-1">${a.bullets}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-number-list" data-trix-attribute="number" title="${a.numbers}" tabindex="-1">${a.numbers}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-decrease-nesting-level" data-trix-action="decreaseNestingLevel" title="${a.outdent}" tabindex="-1">${a.outdent}</button>
        <button type="button" class="trix-button trix-button--icon trix-button--icon-increase-nesting-level" data-trix-action="increaseNestingLevel" title="${a.indent}" tabindex="-1">${a.indent}</button>
      </span>
    </div>

    <div class="trix-dialogs" data-trix-dialogs>
      <div class="trix-dialog trix-dialog--link" data-trix-dialog="href" data-trix-dialog-attribute="href">
        <div class="trix-dialog__link-fields">
          <input type="url" name="href" class="trix-input trix-input--dialog" placeholder="${a.urlPlaceholder}" aria-label="${a.url}" required data-trix-input>
          <div class="trix-button-group">
            <input type="button" class="trix-button trix-button--dialog" value="${a.link}" data-trix-method="setAttribute">
            <input type="button" class="trix-button trix-button--dialog" value="${a.unlink}" data-trix-method="removeAttribute">
          </div>
        </div>
      </div>
    </div>`}})}configure_trix_editor();
